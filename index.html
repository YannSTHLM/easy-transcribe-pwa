<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy Transcribe PWA</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="AI-powered audio transcription app that works offline">
    <!-- Force deployment refresh -->
    <meta name="theme-color" content="#2563eb">
    <meta name="background-color" content="#ffffff">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='90' font-size='90'>üé§</text></svg>">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <!-- Install Banner -->
    <div id="installBanner" class="install-banner">
        <div class="install-content">
            <div class="install-text">
                <strong>üì± Install Easy Transcribe</strong>
                <span>Get the full app experience</span>
            </div>
            <div class="install-actions">
                <button id="installBtn" class="btn-install">Install</button>
                <button id="dismissInstall" class="btn-dismiss">√ó</button>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="app-title">
                    <span class="app-icon">üé§</span>
                    Easy Transcribe
                </h1>
                <div class="connection-status">
                    <div id="statusDot" class="status-dot online"></div>
                    <span id="statusText" class="status-text">Online</span>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="transcribe">
                <span class="tab-icon">üé§</span>
                Transcribe
            </button>
            <button class="nav-tab" data-tab="history">
                <span class="tab-icon">üìö</span>
                History
                <span id="historyBadge" class="tab-badge">0</span>
            </button>
            <button class="nav-tab" data-tab="settings">
                <span class="tab-icon">‚öôÔ∏è</span>
                Settings
            </button>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Transcribe Tab -->
            <div id="transcribeTab" class="tab-content active">
                <!-- Upload Section -->
                <section class="upload-section">
                    <div class="upload-area" id="uploadArea">
                        <input type="file" id="audioFileInput" accept="audio/*" hidden>
                        <div class="upload-content">
                            <div class="upload-icon">üìÅ</div>
                            <h3 class="upload-title">Drop your audio file here</h3>
                            <p class="upload-subtitle">or <button type="button" class="browse-link" id="browseBtn">browse files</button></p>
                            <div class="upload-formats">
                                <small>Supported formats: MP3, WAV, M4A, AAC, OGG, FLAC</small>
                                <small>Maximum file size: 25MB</small>
                            </div>
                        </div>
                        
                        <!-- File Info -->
                        <div id="fileInfo" class="file-info">
                            <div class="file-details">
                                <span class="file-icon">üéµ</span>
                                <div class="file-meta">
                                    <div id="fileName" class="file-name"></div>
                                    <div id="fileSize" class="file-size"></div>
                                </div>
                                <button id="removeFile" class="file-remove">√ó</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Model Selection -->
                <section class="model-section">
                    <h3 class="section-title">
                        <span class="section-icon">ü§ñ</span>
                        Transcription Model
                    </h3>
                    <div class="model-grid">
                        <label class="model-option">
                            <input type="radio" name="model" value="whisper-large-v3" checked>
                            <div class="model-card">
                                <div class="model-name">Whisper Large v3</div>
                                <div class="model-desc">Best Quality</div>
                            </div>
                        </label>
                        <label class="model-option">
                            <input type="radio" name="model" value="whisper-large-v3-turbo">
                            <div class="model-card">
                                <div class="model-name">Whisper Large v3 Turbo</div>
                                <div class="model-desc">Faster Processing</div>
                            </div>
                        </label>
                        <label class="model-option">
                            <input type="radio" name="model" value="distil-whisper-large-v3-en">
                            <div class="model-card">
                                <div class="model-name">Distil Whisper Large v3</div>
                                <div class="model-desc">English Only</div>
                            </div>
                        </label>
                    </div>
                </section>

                <!-- Language Selection -->
                <section class="language-section">
                    <h3 class="section-title">
                        <span class="section-icon">üåç</span>
                        Language (Optional)
                    </h3>
                    <select id="languageSelect" class="language-select">
                        <option value="">Auto-detect</option>
                        <option value="en">English</option>
                        <option value="es">Spanish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="it">Italian</option>
                        <option value="pt">Portuguese</option>
                        <option value="ru">Russian</option>
                        <option value="ja">Japanese</option>
                        <option value="ko">Korean</option>
                        <option value="zh">Chinese</option>
                        <option value="ar">Arabic</option>
                        <option value="hi">Hindi</option>
                        <option value="nl">Dutch</option>
                        <option value="pl">Polish</option>
                        <option value="tr">Turkish</option>
                    </select>
                </section>

                <!-- Transcribe Button -->
                <div class="transcribe-section">
                    <button id="transcribeBtn" class="transcribe-btn" disabled>
                        <span class="btn-icon">üé§</span>
                        Start Transcription
                    </button>
                </div>

                <!-- Progress -->
                <div id="progressSection" class="progress-section">
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill"></div>
                    </div>
                    <div id="progressText" class="progress-text">Processing...</div>
                </div>

                <!-- Results -->
                <section id="resultsSection" class="results-section">
                    <div class="results-header">
                        <h3 class="section-title">
                            <span class="section-icon">üìù</span>
                            Transcription Results
                        </h3>
                        <div class="results-actions">
                            <button id="copyBtn" class="btn-secondary">
                                <span class="btn-icon">üìã</span>
                                Copy
                            </button>
                            <button id="downloadBtn" class="btn-secondary">
                                <span class="btn-icon">üíæ</span>
                                Download
                            </button>
                            <button id="saveBtn" class="btn-secondary">
                                <span class="btn-icon">‚≠ê</span>
                                Save
                            </button>
                        </div>
                    </div>
                    <div id="transcriptionResults" class="results-content">
                        <!-- Transcription text will appear here -->
                    </div>
                </section>

                <!-- API Configuration (Moved to Bottom) -->
                <section class="api-section">
                    <h3 class="section-title">
                        <span class="section-icon">üîë</span>
                        Groq API Configuration
                    </h3>
                    <div class="api-input-group">
                        <div class="input-wrapper">
                            <input 
                                type="password" 
                                id="apiKeyInput" 
                                class="api-input" 
                                placeholder="Enter your Groq API key..."
                                autocomplete="off"
                            >
                            <button type="button" id="toggleApiKey" class="toggle-visibility" title="Show/Hide API Key">
                                üëÅÔ∏è
                            </button>
                        </div>
                        <div class="api-options">
                            <label class="checkbox-wrapper">
                                <input type="checkbox" id="saveApiKey">
                                <span class="checkmark"></span>
                                <span class="checkbox-text">Save API key locally (encrypted)</span>
                            </label>
                        </div>
                        <div class="api-actions">
                            <button id="validateBtn" class="btn-validate">
                                <span class="btn-icon">‚úì</span>
                                Validate API Key
                            </button>
                        </div>
                        <div class="api-help">
                            <small>
                                Get your free API key at <a href="https://console.groq.com/" target="_blank" rel="noopener">console.groq.com</a>
                            </small>
                        </div>
                    </div>
                </section>
            </div>

            <!-- History Tab -->
            <div id="historyTab" class="tab-content">
                <div class="history-header">
                    <h2 class="tab-title">Transcription History</h2>
                    <div class="history-actions">
                        <button id="exportBtn" class="btn-secondary">
                            <span class="btn-icon">üì§</span>
                            Export
                        </button>
                        <button id="clearHistoryBtn" class="btn-secondary">
                            <span class="btn-icon">üóëÔ∏è</span>
                            Clear All
                        </button>
                    </div>
                </div>
                <div id="historyList" class="history-list">
                    <div class="history-empty">
                        <div class="empty-icon">üìö</div>
                        <h3>No transcriptions yet</h3>
                        <p>Your transcription history will appear here after you process audio files.</p>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settingsTab" class="tab-content">
                <div class="settings-header">
                    <h2 class="tab-title">Settings</h2>
                </div>
                
                <div class="settings-section">
                    <h3 class="section-title">
                        <span class="section-icon">üîí</span>
                        Privacy & Security
                    </h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-name">Auto-save API Key</div>
                            <div class="setting-desc">Automatically save your API key for future sessions</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="autoSaveToggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-name">Save Transcription History</div>
                            <div class="setting-desc">Keep a local history of your transcriptions</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="saveHistoryToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <h3 class="section-title">
                        <span class="section-icon">üé®</span>
                        Appearance
                    </h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-name">Dark Mode</div>
                            <div class="setting-desc">Use dark theme for better viewing in low light</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="darkModeToggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <h3 class="section-title">
                        <span class="section-icon">üîß</span>
                        Application
                    </h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-name">Clear All Data</div>
                            <div class="setting-desc">Remove all saved data including API keys and history</div>
                        </div>
                        <button id="clearDataBtn" class="btn-danger">
                            Clear Data
                        </button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3 class="section-title">
                        <span class="section-icon">‚ÑπÔ∏è</span>
                        About
                    </h3>
                    <div class="about-info">
                        <p><strong>Easy Transcribe PWA</strong> v1.0.0</p>
                        <p>A Progressive Web App for AI-powered audio transcription using Groq's Whisper models.</p>
                        <p>Your data stays private - everything is processed locally and encrypted.</p>
                        <div class="about-links">
                            <a href="https://github.com/YannSTHLM/easy-transcribe-pwa" target="_blank" rel="noopener">
                                üìÇ GitHub Repository
                            </a>
                            <a href="https://console.groq.com/" target="_blank" rel="noopener">
                                üîë Get API Key
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div id="loadingText" class="loading-text">Loading...</div>
        </div>
    </div>

    <!-- Alert Messages -->
    <div id="alertContainer" class="alert-container"></div>

    <!-- Scripts -->
    <script src="./storage.js"></script>
    <script src="./app.js"></script>
    <script src="./app-utils.js"></script>
    <script src="./ui-enhancements.js"></script>
</body>
</html>